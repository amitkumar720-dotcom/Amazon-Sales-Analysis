CREATE TABLE tableName (
    CREATE DATABASE AMAZON;	VARCHAR(512)
);

INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('USE AMAZON;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- Data Wrangling');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- checking null values so null values are present in this dataset.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('CREATE TABLE amazon_sales_data ( invoice_id VARCHAR(30) NOT NULL PRIMARY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('KEY, branch VARCHAR(5) NOT NULL, city VARCHAR(30) NOT NULL,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('customer_type VARCHAR(30) NOT NULL, gender VARCHAR(10) NOT NULL,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('product_line VARCHAR(100) NOT NULL, unit_price DECIMAL(10 , 2 ) NOT');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('NULL, quantity INT(20) NOT NULL, tax_pct FLOAT(6 , 4 ) NOT NULL, total');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('DECIMAL(12 , 4 ) NOT NULL, date DATETIME NOT NULL, time TIME NOT NULL,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('payment VARCHAR(15) NOT NULL, cogs DECIMAL(10 , 2 ) NOT NULL,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('gross_margin_pct FLOAT(11 , 9 ), gross_income DECIMAL(12 , 4 ), rating');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('FLOAT(2 , 1 ) );');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- Feature Engineering');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 2.1 Add a new column named timeofday to give insight of sales in the');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('Morning, Afternoon and Evening. This will help answer the question on');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('which part of the day most sales are ma');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT time,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('(CASE WHEN `time` BETWEEN "00:00:00" AND "12:00:00" THEN "Morning" WHEN');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('`time` BETWEEN "12:01:00" AND "16:00:00" THEN "Afternoon" WHEN `time`');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('BETWEEN "17:01:00" AND "20:00:00" THEN "EVENING" ELSE "NIGHT" END) AS');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('time_of_day FROM AMAZON_sales_data ;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('ALTER TABLE AMAZON_sales_data ADD COLUMN time_of_day VARCHAR(20);');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('UPDATE AMAZON_sales_data SET time_of_day = ( CASE WHEN `time` BETWEEN');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('"00:00:00" AND "12:00:00" THEN "Morning" WHEN `time` BETWEEN "12:01:00"');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('AND "16:00:00" THEN "Afternoon" WHEN `time` BETWEEN "17:01:00" AND');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('"20:00:00" THEN "EVENING" ELSE "NIGHT" END ); -- 2.2 Add a new column');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('named dayname that contains the extracted days of the week on which the');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('given transaction took place (Mon, Tue, Wed, Thur, Fri). This will help');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('answer the question on which week of the day each branch is busiest.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('select date,dayname(date) from amazon_sales_data; ALTER TABLE');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('AMAZON_sales_data ADD COLUMN day_name VARCHAR(10); UPDATE');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('AMAZON_sales_data set day_name=dayname(date); UPDATE AMAZON_sales_data');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SET date= date_format(str_to_date(date,\'%d-%m-%Y\'), \'%Y-%m-%d\');');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 2.3 Add a new column named monthname that contains the extracted');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('months of the year on which the given transaction took place (Jan, Feb,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('Mar). Help determine which month of the year has the most sales and');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('profit.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('ALTER TABLE AMAZON_sales_data ADD COLUMN month_name VARCHAR(10);');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('UPDATE AMAZON_sales_data SET month_name = MONTHNAME(date);');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- Exploratory Data Analysis');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('select \* from amazon_sales_data;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- Business Questions To Answer: -- Product Analysis');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 1. What is the count of distinct cities in the dataset? select');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('count(distinct city)from amazon_sales_data;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 2. For each branch, what is the corresponding city? select');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('branch,city from amazon_sales_data;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 3. What is the count of distinct product lines in the dataset? select');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('count(distinct product_line )from amazon_sales_data;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 4. Which payment method occurs most frequently? SELECT payment,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('COUNT(payment) AS common_payment_method FROM amazon_sales_data GROUP BY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('payment ORDER BY common_payment_method DESC LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 5. How much revenue is generated each month? Select month_name as');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('Month,sum(total) as Total_Revenue from amazon_sales_data group by');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('month_name order by Total_Revenue Desc ;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 6. In which month did the cost of goods sold reach its peak? select');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('month_name as month,sum(cogs) as cogs from amazon_sales_data group by');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('month_name order by cogs desc;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 7. Which product line generated the highest revenue? select');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('Product_line, sum(total) as Total_revenue from amazon_sales_data group');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('by Product_line order by Total_revenue desc limit 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 8. In which city was the highest revenue recorded? select city,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('sum(total) as Total_revenue from amazon_sales_data group by city order');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('by Total_revenue desc;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 9. Which product line incurred the highest Value Added Tax? SELECT');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('product_line, SUM(tax_pct) as VAT FROM amazon_sales_data GROUP BY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('product_line ORDER BY VAT DESC LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 10. For each product line, add a column indicating "Good" if its');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('sales are above average, otherwise "Bad." SELECT AVG(quantity) AS');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('avg_qnty FROM amazon_sales_data;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT product_line, CASE WHEN AVG(quantity) \> 6 THEN "Good" ELSE "Bad"');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('END AS remark FROM amazon_sales_data GROUP BY product_line;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 11. Identify the branch that exceeded the average number of products');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('sold. SELECT branch,SUM(quantity) AS quantities FROM amazon_sales_data');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('GROUP BY branch HAVING SUM(quantity) \> (SELECT AVG(quantity) FROM');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('amazon_sales_data);');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 12. Which product line is most frequently associated with each');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('gender? SELECT gender,product_line,COUNT(gender) AS total_cnt FROM');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('amazon_sales_data GROUP BY gender, product_line ORDER BY total_cnt DESC;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 13. Calculate the average rating for each product line. SELECT');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('ROUND(AVG(rating), 2) as avg_rating, product_line FROM amazon_sales_data');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('GROUP BY product_line ORDER BY avg_rating DESC;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- Sales Analysis');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 14. Count the sales occurrences for each time of day on every');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('weekday. select time_of_day,count(\*) as total_sales from');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('amazon_sales_data where day_name = "Sunday" group by time_of_day\');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('order by total_sales desc;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 15. Identify the customer type contributing the highest revenue.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('select customer_type, round (sum(total), 2) as total_revenue from');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('amazon_sales_data group by customer_type order by total_revenue;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 16. Determine the city with the highest VAT percentage. SELECT city,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SUM(tax_PCT) AS total_VAT FROM AMAZON_sales_DATA GROUP BY city ORDER BY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('total_VAT DESC LIMIT 3;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 17. Identify the customer type with the highest VAT payments. SELECT');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('customer_type, SUM(TAX_PCT) AS total_VAT FROM AMAZON_sales_DATA GROUP BY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('customer_type ORDER BY total_VAT DESC LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 18. What is the count of distinct customer types in the dataset?');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT COUNT(DISTINCT customer_type) FROM AMAZON_sales_DATA;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 19.. What is the count of distinct payment methods in the dataset?');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT COUNT(DISTINCT PAYMENT) FROM AMAZON_sales_DATA;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 20. Which customer type occurs most frequently? SELECT customer_type,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SUM(total) as total_sales FROM AMAZON_sales_DATA GROUP BY customer_type');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('ORDER BY total_sales LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- Customer Analysis');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 21. Identify the customer type with the highest purchase frequency.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT customer_type, COUNT(customer_type) AS common_customer FROM');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('AMAZON_sales_DATA GROUP BY customer_type ORDER BY common_customer DESC');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 22. Determine the predominant gender among customers. SELECT gender,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('COUNT(\*) AS all_genders FROM AMAZON_sales_DATA GROUP BY gender ORDER BY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('all_genders DESC LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 23. Examine the distribution of genders within each branch. SELECT');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('branch, gender, COUNT(gender) AS gender_distribution FROM');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('AMAZON_sales_DATA GROUP BY branch, gender ORDER BY branch;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 24. Identify the time of day when customers provide the most ratings.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT branch, gender, COUNT(gender) AS gender_distribution FROM');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('AMAZON_sales_DATA GROUP BY branch, gender ORDER BY branch;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 25. Determine the time of day with the highest customer ratings for');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('each branch. SELECT branch, time_of_day, AVG(rating) AS average_rating');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('FROM AMAZON_sales_DATA GROUP BY branch, time_of_day ORDER BY');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('average_rating DESC;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 26. Identify the day of the week with the highest average ratings.');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SELECT day_name, AVG(rating) AS average_rating FROM AMAZON_sales_DATA');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('GROUP BY day_name ORDER BY average_rating DESC LIMIT 1;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 27. Determine the day of the week with the highest average ratings');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('for each branch. SELECT branch, day_name, AVG(rating) AS average_rating');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('FROM AMAZON_sales_DATA GROUP BY day_name, branch ORDER BY average_rating');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('DESC;');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('-- 28. What is the total revenue generated by different customer types');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('for each gender in the Amazon sales data? SELECT Gender, Customer_type,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('SUM(Total) AS Total_Revenue FROM AMAZON_sales_DATA GROUP BY Gender,');
INSERT INTO tableName (CREATE DATABASE AMAZON;) VALUES ('Customer_type;');
